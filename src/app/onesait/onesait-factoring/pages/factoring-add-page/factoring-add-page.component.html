<osb-loader *ngIf="loading"></osb-loader>

<div class="page-non-tabbed pb-1 mt-1 p-dynamic">
  <div class="row">
    <div class="panel ">
      <div class="panel-body">
        <ng-container *ngIf="step === 'FIRST'">
          <form [formGroup]="newFactoringForm" id="form">
            <div class="col-xs-12 mt-1">
              <div class="col-xs-12 col-sm-6">
                <div>
                  <div class="form-group col-xs-12"><b>{{'ONESAIT-FACTORING.ADD.SELECT' | translate}}</b>
                  </div>
                  <div class="form-select-custom">
                    <select class="form-control" formControlName="product" name="product">
                      <option *ngFor="let product of products" [ngValue]="product">{{ product.name | capitalize }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="row mt-1">
                  <div class="col-xs-12 col-sm-12 col-md-12">
                    <label class="radio-inline">
                      <input formControlName="radioForm" type="radio" value="optResource">{{'ONESAIT-FACTORING.ADD.RESOURCE'
                                |
                                translate}}
                    </label>
                    <label class="radio-inline">
                      <input formControlName="radioForm" type="radio" value="optNoResource">{{'ONESAIT-FACTORING.ADD.NO-RESOURCE'
                                | translate}}
                    </label>
                    <label class="form-custom-label">
                      {{'ONESAIT-FACTORING.ADD.INFO-RESOURCE' | translate}} <a href="wwww.google.com">{{'ONESAIT-FACTORING.ADD.HERE'
                                  | translate}}</a>
                    </label>
                  </div>
                </div>

                <div class="row mt-2">
                  <div class="col-xs-12">
                    <div class="box-form-info">
                      <div class="info-section-group">
                        <div class="row">
                          <div class="col-xs-6 mb-1" *ngIf="accountInfo.username">
                            <div><b>{{'ONESAIT-FACTORING.ADD.OWNERSHIP' | translate}}</b></div>
                            <div class="text-gray-dark">{{ accountInfo.username }}</div>
                          </div>
                          <div class="col-xs-6 mb-1" *ngIf="accountInfo.userId">
                            <div><b>{{'ONESAIT-FACTORING.ADD.CIF' | translate}}</b></div>
                            <div class="text-gray-dark">{{ accountInfo.userId }}</div>
                          </div>
                        </div>
                        <div class="mb-1" *ngIf="accountInfo.attorney">
                          <div><b>{{'ONESAIT-FACTORING.ADD.ATTORNEY' | translate}}</b></div>
                          <div class="text-gray-dark">{{ accountInfo.attorney }}</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-xs-12 col-sm-6 mb-1">
                <div class="box-form-info">
                  <div class="info-section-group">
                    <div class="mt-1 mb-1"><b>{{'ONESAIT-FACTORING.ADD.INFO' | translate}}</b></div>
                    <div class="text-gray-dark">
                      <p>
                        {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT1' | translate}}
                      </p>
                      <p>
                        {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT2' | translate}}
                        <p>
                          {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT3' | translate}}
                          <p>
                            {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT4' | translate}}
                          </p>
                          <p>
                            {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT5' | translate}}
                          </p>
                          <p>
                            {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT6' | translate}}
                          </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </form>

          <div class="col-xs-6">
            <button class="btn btn-terciary" (click)="cancel()">
              {{ 'COMMON.CANCEL' | translate }}
            </button>
          </div>
          <div class="col-xs-6 text-right">
            <button class="btn btn-primary" [disabled]="!newFactoringForm.valid" (click)="confirm()">
              {{ 'COMMON.CONTINUE' | translate }}
            </button>
          </div>
        </ng-container>
        <!-- TOKEN -->

        <ng-container *ngIf="step === 'TOKEN'">
          <div class="row">
            <div class="col-xs-12 col-md-6 col-md-offset-3">
              <osb-signature [signatureEntity]="signatureEntity"></osb-signature>
            </div>
          </div>
          <div class="col-xs-12 text-center">
            <div class="row">
              <div class="col-xs-12 col-sm-3 col-md-2 mb-1 mt-1">
                <button class="btn btn-terciary" (click)="cancel()">{{ 'COMMON.CANCEL' | translate }}</button>
              </div>

              <div class="col-xs-12 col-sm-3 col-md-3 col-sm-offset-3 col-md-offset-5 mb-1 mt-1">
                <button class=" btn btn-terciary" (click)="back()">{{ 'COMMON.BACK' | translate }} </button>
              </div>

              <div class="col-xs-12 col-sm-3 col-md-2 mb-1 mt-1">
                <button class="btn btn-primary" [disabled]="!signatureEntity.tokenValid"
                  (click)="confirm()">{{'COMMON.FINALIZE' | translate }}</button>
              </div>
            </div>
          </div>
        </ng-container>

        <!-- RESUMEN -->

        <ng-container *ngIf="step === 'RESUME'">
          <osb-voucher-container #voucherContainer>
            <div class="col-xs-12">
              <div class="form-group col-xs-12 mt-1 mb-1">
                <b>{{'ONESAIT-FACTORING.ADD.SUCCESS' | translate}}</b>
              </div>
              <div class="row">
                <div class="col-md-6 col-xs-12">
                  <div class="info-section">
                    <div class="form-group col-xs-12">
                      <div class="row">
                        <div class="col-xs-12">

                          <div class="box-form-info">
                            <div class="info-section-group">
                              <div class="row mt-1">
                                <div OsbVoucherKeyValue class="col-xs-6">
                                  <div><b OsbVoucherKey>{{'ONESAIT-FACTORING.ADD.DATE-TIME' | translate}}</b>
                                  </div>
                                  <div class="text-gray-dark" OsbVoucherValue>{{ finishDate | dateLocalized:'short'}}
                                  </div>
                                </div>
                                <div OsbVoucherKeyValue class="col-xs-6">
                                  <div><b OsbVoucherKey>{{'ONESAIT-FACTORING.ADD.CONTRACT' | translate}}</b>
                                  </div>
                                  <div class="text-gray-dark" OsbVoucherValue>
                                    {{ newFactoringForm.controls.product.value.name }}<span
                                      *ngIf="newFactoringForm.value.radioForm === 'optResource'">
                                      ({{'ONESAIT-FACTORING.ADD.RESOURCE' |
                                            translate}})</span>
                                    <span *ngIf="newFactoringForm.value.radioForm === 'optNoResource'">
                                      ({{'ONESAIT-FACTORING.ADD.NO-RESOURCE'
                                            | translate}})</span>
                                  </div>
                                </div>
                              </div>
                              <div class="row mt-2">
                                <div OsbVoucherKeyValue class="col-xs-6 mb-1" *ngIf="accountInfo.username">
                                  <div><b OsbVoucherKey>{{'ONESAIT-FACTORING.ADD.OWNERSHIP' | translate}}</b>
                                  </div>
                                  <div class="text-gray-dark" OsbVoucherValue>{{ accountInfo.username }}</div>
                                </div>
                                <div OsbVoucherKeyValue class="col-xs-6 mb-1" *ngIf="accountInfo.userId">
                                  <div><b OsbVoucherKey>{{'ONESAIT-FACTORING.ADD.CIF' | translate}}</b>
                                  </div>
                                  <div class="text-gray-dark" OsbVoucherValue>{{ accountInfo.userId }}</div>
                                </div>
                              </div>
                              <div OsbVoucherKeyValue class="mb-1" *ngIf="accountInfo.attorney">
                                <div><b OsbVoucherKey>{{'ONESAIT-FACTORING.ADD.ATTORNEY' | translate}}</b>
                                </div>
                                <div class="text-gray-dark" OsbVoucherValue>{{ accountInfo.attorney }}</div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xs-12 col-sm-6 mb-1">
                  <div class="box-form-info">
                    <div class="info-section-group">
                      <div OsbVoucherKeyValue class="mt-1 mb-1"><b>{{'ONESAIT-FACTORING.ADD.INFO' | translate}}</b>
                      </div>
                      <div class="text-gray-dark">
                        <p>
                          {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT1' | translate}}

                        </p>
                        <p>
                          {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT2' | translate}}
                        </p>
                        <p>
                          {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT3' | translate}}
                        </p>
                        <p>
                          {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT4' | translate}}
                        </p>
                        <p>
                          {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT5' | translate}}
                        </p>
                        <p>
                          {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT6' | translate}}
                        </p>
                      </div>
                      <div class="hidden" OsbVoucherValue>
                        {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT1' | translate}}
                        {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT2' | translate}}
                        {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT3' | translate}}
                        {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT4' | translate}}
                        {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT5' | translate}}
                        {{'ONESAIT-FACTORING.ADD.INFO-PRODUCT6' | translate}}
                      </div>
                    </div>
                  </div>
                </div>

              </div>
              <div class="col-xs-6 mb-1" *ngIf="voucherContainer">
                <osb-download-info [voucherContainer]="voucherContainer"
                  text="{{'ONESAIT-FACTORING.ADD.DOWNLOAD' | translate}}">
                </osb-download-info>
              </div>
              <div class="col-xs-6">
                <button class="btn btn-primary  pull-right" (click)="accept()">
                  {{ 'COMMON.GO-GLOBAL-POSITION' | translate }} </button>
              </div>
            </div>
          </osb-voucher-container>
        </ng-container>
      </div>
    </div>
  </div>
</div>